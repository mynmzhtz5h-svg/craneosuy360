<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>CraneosUY360 - Slideshow</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body, html { width: 100%; height: 100%; overflow: hidden; background: black; }
        video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        #qr { position: absolute; bottom: 20px; right: 20px; width: 150px; height: 150px; border: 3px solid white; border-radius: 10px; background: white; }
        #qr img { width: 100%; height: 100%; }
        #title { position: absolute; bottom: 180px; right: 20px; color: white; font-size: 24px; text-shadow: 2px 2px 5px black; }
    </style>
</head>
<body>
    <video id="slideshow" autoplay muted></video>
    <div id="title"></div>
    <div id="qr"><img id="qr-img" src=""></div>

    <script>
        let videos = [];
        let index = 0;
        const videoEl = document.getElementById('slideshow');
        const qrImg = document.getElementById('qr-img');
        const titleEl = document.getElementById('title');

        // Función para cargar videos.json
        async function loadVideos() {
            try {
                const res = await fetch('videos.json');
                videos = await res.json();
                if(videos.length === 0) {
                    videoEl.style.display = 'none';
                    qrImg.style.display = 'none';
                    titleEl.innerText = "No hay videos disponibles aún.";
                } else {
                    playVideo(0);
                }
            } catch(e) {
                console.error("Error cargando videos:", e);
                titleEl.innerText = "Error cargando videos.";
            }
        }

        // Función para reproducir un video del slideshow
        function playVideo(i) {
            if(videos.length === 0) return;
            index = i % videos.length;
            const video = videos[index];
            videoEl.src = video.url;
            qrImg.src = video.qr;
            titleEl.innerText = video.title;
            videoEl.play();

            // Cuando termina el video, pasa al siguiente
            videoEl.onended = () => {
                playVideo((index + 1) % videos.length);
            };
        }

        // Recarga videos.json cada 30 segundos para detectar nuevos videos
        setInterval(loadVideos, 30000);

        // Cargar inicialmente
        loadVideos();
    </script>
</body>
</html>
